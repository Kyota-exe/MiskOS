From 5a0fc24e7b81b2a8a3a27ba160f81f6d48b486d0 Mon Sep 17 00:00:00 2001
From: Kyota Poeti <kyota.exe@gmail.com>
Date: Sat, 14 May 2022 20:31:52 -0400
Subject: [PATCH 1/1] Replace FIONREAD with 0

---
 lib/readline/input.c | 8 ++++----
 lib/sh/input_avail.c | 4 ++--
 2 files changed, 6 insertions(+), 6 deletions(-)

diff --git a/lib/readline/input.c b/lib/readline/input.c
index 497cdf9..af44012 100644
--- a/lib/readline/input.c
+++ b/lib/readline/input.c
@@ -236,7 +236,7 @@ rl_gather_tyi (void)
 
   result = -1;
   errno = 0;
-#if defined (FIONREAD)
+#if 0
   result = ioctl (tty, FIONREAD, &chars_avail);
   if (result == -1 && errno == EIO)
     return -1;
@@ -334,7 +334,7 @@ _rl_input_available (void)
   fd_set readfds, exceptfds;
   struct timeval timeout;
 #endif
-#if defined(FIONREAD)
+#if 0
   int chars_avail;
 #endif
   int tty;
@@ -353,7 +353,7 @@ _rl_input_available (void)
   return (select (tty + 1, &readfds, (fd_set *)NULL, &exceptfds, &timeout) > 0);
 #else
 
-#if defined (FIONREAD)
+#if 0
   if (ioctl (tty, FIONREAD, &chars_avail) == 0)
     return (chars_avail);
 #endif
@@ -375,7 +375,7 @@ _rl_nchars_available ()
   
   chars_avail = 0;
      
-#if defined (FIONREAD)
+#if 0
   fd = fileno (rl_instream);
   errno = 0;    
   result = ioctl (fd, FIONREAD, &chars_avail);    
diff --git a/lib/sh/input_avail.c b/lib/sh/input_avail.c
index 0db1d05..9221450 100644
--- a/lib/sh/input_avail.c
+++ b/lib/sh/input_avail.c
@@ -88,7 +88,7 @@ input_avail (fd)
   return ((result <= 0) ? 0 : 1);
 #endif
 
-#if defined (FIONREAD)
+#if 0
   errno = 0;
   result = ioctl (fd, FIONREAD, &chars_avail);
   if (result == -1 && errno == EIO)
@@ -149,7 +149,7 @@ nchars_avail (fd, nchars)
       if (result < 0)
         return -1;
 
-#if defined (FIONREAD)
+#if 0
       errno = 0;
       result = ioctl (fd, FIONREAD, &chars_avail);
       if (result == -1 && errno == EIO)
-- 
2.25.1

